{% assign items = site.data.updates | sort: "date" | reverse %}
{% assign max = 5 %}

<section id="updates" class="updates">

  <ul class="updates__list">
    {% for it in items limit: max %}

      {%- comment -%} Select icon: explicit icon > type-based > fallback {%- endcomment -%}
      {% assign icon = it.icon %}
      {% if icon == nil or icon == '' %}
        {% case it.type %}
          {% when 'talk'    %}{% assign icon = "ğŸ¤" %}
          {% when 'paper'   %}{% assign icon = "ğŸ“" %}
          {% when 'award'   %}{% assign icon = "ğŸ†" %}
          {% when 'service' %}{% assign icon = "ğŸ§©" %}
          {% when 'grant'   %}{% assign icon = "ğŸ’°" %}
          {% when 'media'   %}{% assign icon = "ğŸ“¢" %}
          {% when 'release' %}{% assign icon = "ğŸš€" %}
          {% when 'code'    %}{% assign icon = "ğŸ’»" %}
          {% else           %}{% assign icon = "ğŸ“Œ" %}
        {% endcase %}
      {% endif %}

      <li class="updates__item">
        <div class="updates__icon" aria-hidden="true">{{ icon }}</div>

        <div class="updates__body">
          <div class="updates__headline">
            <time class="updates__date" datetime="{{ it.date | date_to_xmlschema }}">
              {{ it.date | date: "%d %b %Y" }}
            </time>

            {% if it.title %}
              <span class="updates__title">
                {{ it.title }}  {# plain text title (no link) #}
              </span>
            {% endif %}

            {% if it.link and it.link.url and it.link.label %}
              <span class="updates__sep">Â·</span>
              <a class="updates__extra"
                 href="{{ it.link.url }}"
                 {% unless it.link.url contains site.url %}
                   target="_blank" rel="noopener noreferrer"
                 {% endunless %}>
                {{ it.link.label }}
              </a>
            {% endif %}
          </div>

          {% if it.text %}
            <div class="updates__text">{{ it.text }}</div>
          {% endif %}
        </div>
      </li>

    {% endfor %}
  </ul>

</section>
